import DiscordHelpCard from "/snippets/discord-help-card.mdx";

## Getting started with Next.js

Start accepting x402 payments in your Next.js app in 2 minutes.

<Note>
  For the fastest setup, use the official starter:
  <a href="https://www.npmjs.com/package/@payai/x402-next-starter">@payai/x402-next-starter</a>.
</Note>

### Step 1: Create a new app from the starter template

Use your favorite package manager.

##### npm (npx)
```bash
npx @payai/x402-next-starter my-first-app
```

##### pnpm
```bash
pnpm dlx @payai/x402-next-starter my-first-app
```

##### bun
```bash
bunx @payai/x402-next-starter my-first-app
```

The starter bootstraps a production-ready Next.js app with x402 payment middleware already wired up.

### Step 2: Set your environment variables

In your generated project, copy the example env and fill in your values:

```bash
cd my-first-app
cp env.example .env.local
```

Update `.env.local` with:

- `FACILITATOR_URL`: Facilitator base URL (defaults to: https://facilitator.payai.network)
- `NETWORK`: Network to use for the facilitator (e.g. `eip155:84532`, `eip155:8453`, `solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1`, `solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp`)
- `ADDRESS`: Wallet public address to receive payments to (e.g. `0x...` for Base, `So11111111111111111111111111111111111111112` for Solana)

```env
FACILITATOR_URL=https://facilitator.payai.network
NETWORK=eip155:84532 # or eip155:8453, solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1, etc.
ADDRESS=0x... # wallet public address you want to receive payments to
```

### Step 3: Explore the generated app

The starter includes a minimal example showing both a free API route and premium content protected by x402.

```text
├── app/
│   ├── api/                 # API routes
│   ├── premium/             # Premium content page
│   ├── globals.css          # Global styles
│   ├── layout.tsx           # Root layout
│   └── page.tsx             # Home page
├── middleware.ts            # x402 payment middleware
├── next.config.js           # Next.js configuration
├── tailwind.config.js       # Tailwind CSS configuration
├── tsconfig.json            # TypeScript configuration
└── package.json             # Dependencies and scripts
```

- Adjust pricing, networks, and protected paths in `middleware.ts`.
- Add your own protected pages under `app/premium/*` or secure API routes under `app/api/*`.

### Step 4: Preview the middleware

The payment middleware in `middleware.ts` protects your routes:

```typescript
import { paymentMiddleware } from "@x402/next";

export const middleware = paymentMiddleware(
  process.env.ADDRESS!,
  {
    "/api/premium/*": {
      price: "$0.001",
      network: process.env.NETWORK || "eip155:84532",
    },
    "/premium/*": {
      price: "$0.001", 
      network: process.env.NETWORK || "eip155:84532",
    },
  },
  { url: process.env.FACILITATOR_URL! },
);

export const config = {
  matcher: ["/api/premium/:path*", "/premium/:path*"],
};
```

Adjust pricing, networks, and protected paths to match your needs.

### Step 5: Run the app

```bash
npm run dev
```

<Check>
  Your Next.js app is now accepting x402 payments!
</Check>

### Step 6: Test the server

The starter includes a built-in paywall at the home page. Navigate to `http://localhost:3000` to test payments directly.

You can also test programmatically by following the [fetch example](/x402/clients/typescript/fetch) or [axios example](/x402/clients/typescript/axios).

## Need help?

<DiscordHelpCard />